#include ../data/case14.txt
#include ../lib/idx_gen.txt
#include ../lib/idx_bus.txt
#include ../lib/idx_brch.txt
#include ../lib/make_y_bus.txt
#include ../lib/dsbus_dv.txt
#include ../lib/make_sdzip.txt
#include ../lib/make_sbus.txt
#include ../lib/newtonpf.txt
#include ../lib/runpf.txt

info(`Running power flow on case14...`);
for i in 0..100 {
    r = runpf();
}
info(`Run power flow on case14 end`);

assert_relative_eq(r, [
    [c(1.0600,0)],
    [c(1.0411,-0.0907)],
    [c(0.9852,-0.2225)],
    [c(1.0012,-0.1822)],
    [c(1.0076,-0.1555)],
    [c(1.0372,-0.2628)],
    [c(1.0328,-0.2453)],
    [c(1.0605,-0.2519)],
    [c(1.0202,-0.2722)],
    [c(1.0147,-0.2737)],
    [c(1.0219,-0.2698)],
    [c(1.0189,-0.2744)],
    [c(1.0138,-0.2746)],
    [c(0.9952,-0.2860)]
],4);